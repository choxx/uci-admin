import { __extends } from "tslib";
import { Injectable } from '@angular/core';
import { BaseService } from './base.service';
import * as i0 from "@angular/core";
import * as i1 from "@angular/common/http";
import * as i2 from "./global.service";
var UciService = /** @class */ (function (_super) {
    __extends(UciService, _super);
    function UciService(http, globalService) {
        var _this = _super.call(this, http, globalService) || this;
        _this.http = http;
        _this.globalService = globalService;
        _this.FORM_BASE_URL = 'https://dev.sunbirded.org/';
        _this.globalService.baseUrl$.subscribe(function (value) {
            if (value) {
                _this.BASE_URL = value + '/admin/v1/';
                _this.DATASET_URL = value.replace('/uci') + '/dataset/v1/';
            }
        });
        return _this;
    }
    UciService.prototype.fetchConversation = function (params) {
        return this.getRequest(this.BASE_URL + 'bot/get', params, { asset: 'bot' });
    };
    UciService.prototype.searchConversation = function (params) {
        return this.getRequest(this.BASE_URL + 'bot/search', params, { asset: 'bot' });
    };
    UciService.prototype.pauseConversation = function (botId) {
        return this.getRequest(this.BASE_URL + ("bot/pause/" + botId), {}, { asset: 'bot' });
    };
    UciService.prototype.startConversation = function (botId) {
        return this.getRequest(this.BASE_URL + ("bot/start/" + botId), {}, { asset: 'bot' });
    };
    UciService.prototype.deleteConversation = function (botId) {
        return this.getRequest(this.BASE_URL + ("bot/delete/" + botId), {}, { asset: 'bot' });
    };
    UciService.prototype.getBotDetails = function (id) {
        return this.getRequest(this.BASE_URL + ("bot/get/" + id), {}, { asset: 'bot' });
    };
    UciService.prototype.getCheckStartingMessage = function (param) {
        return this.getRequest(this.BASE_URL + "bot/getByParam", param, { asset: 'bot' });
    };
    UciService.prototype.botCreate = function (data) {
        return this.postRequest(this.BASE_URL + 'bot/create', data, { asset: 'bot' });
    };
    UciService.prototype.botUpdate = function (id, data) {
        return this.postRequest(this.BASE_URL + ("bot/update/" + id), data, { asset: 'bot' });
    };
    // User Segment APIs
    UciService.prototype.fetchUserSegment = function (params) {
        return this.getRequest(this.BASE_URL + 'userSegment/get', params, { asset: 'userSegment' });
    };
    UciService.prototype.searchUserSegment = function (params) {
        return this.getRequest(this.BASE_URL + 'userSegment/search', params, { asset: 'userSegment' });
    };
    UciService.prototype.createUserSegment = function (data) {
        return this.postRequest(this.BASE_URL + 'userSegment/create', data, { asset: 'userSegment' });
    };
    UciService.prototype.userSegmentQueryBuilder = function (data) {
        return this.postRequest(this.BASE_URL + 'userSegment/queryBuilder', data, { asset: 'userSegment' });
    };
    // Conversation APIs
    UciService.prototype.createLogic = function (data) {
        return this.postRequest(this.BASE_URL + 'conversationLogic/create', data, { asset: 'conversationLogic' });
    };
    UciService.prototype.updateLogic = function (id, data) {
        return this.postRequest(this.BASE_URL + ("conversationLogic/update/" + id), data, { asset: 'conversationLogic' });
    };
    UciService.prototype.deleteLogic = function (id) {
        return this.getRequest(this.BASE_URL + ("conversationLogic/delete/" + id), {}, { asset: 'conversationLogic' });
    };
    // Mis APIs
    UciService.prototype.uploadFile = function (obj) {
        return this.postRequest(this.BASE_URL + 'forms/upload', this.toFormData(obj));
    };
    UciService.prototype.readForm = function (data) {
        return this.postRequest(this.FORM_BASE_URL + 'api/data/v1/form/read', data);
    };
    // Exhaust API
    UciService.prototype.getJobList = function (id, params) {
        return this.getRequest(this.DATASET_URL + ("request/list/" + id), params, { asset: 'conversationLogic' });
    };
    UciService.prototype.getJobInfo = function (id, params) {
        return this.getRequest(this.DATASET_URL + ("request/read/" + id), params, { asset: 'conversationLogic' });
    };
    UciService.prototype.submitExhaust = function (data) {
        return this.postRequest(this.DATASET_URL + "request/submit", data, { asset: 'conversationLogic' });
    };
    UciService.ɵfac = function UciService_Factory(t) { return new (t || UciService)(i0.ɵɵinject(i1.HttpClient), i0.ɵɵinject(i2.GlobalService)); };
    UciService.ɵprov = i0.ɵɵdefineInjectable({ token: UciService, factory: UciService.ɵfac, providedIn: 'root' });
    return UciService;
}(BaseService));
export { UciService };
/*@__PURE__*/ (function () { i0.ɵsetClassMetadata(UciService, [{
        type: Injectable,
        args: [{
                providedIn: 'root'
            }]
    }], function () { return [{ type: i1.HttpClient }, { type: i2.GlobalService }]; }, null); })();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoidWNpLnNlcnZpY2UuanMiLCJzb3VyY2VSb290Ijoibmc6Ly9Ac2FtYWdyYS14L3VjaS1jb25zb2xlLyIsInNvdXJjZXMiOlsibGliL3NlcnZpY2VzL3VjaS5zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEVBQUMsVUFBVSxFQUFDLE1BQU0sZUFBZSxDQUFDO0FBRXpDLE9BQU8sRUFBQyxXQUFXLEVBQUMsTUFBTSxnQkFBZ0IsQ0FBQzs7OztBQUkzQztJQUdnQyw4QkFBVztJQUt2QyxvQkFBbUIsSUFBZ0IsRUFBUyxhQUE0QjtRQUF4RSxZQUNJLGtCQUFNLElBQUksRUFBRSxhQUFhLENBQUMsU0FPN0I7UUFSa0IsVUFBSSxHQUFKLElBQUksQ0FBWTtRQUFTLG1CQUFhLEdBQWIsYUFBYSxDQUFlO1FBRnhFLG1CQUFhLEdBQUcsNEJBQTRCLENBQUM7UUFJekMsS0FBSSxDQUFDLGFBQWEsQ0FBQyxRQUFRLENBQUMsU0FBUyxDQUFDLFVBQUEsS0FBSztZQUN2QyxJQUFJLEtBQUssRUFBRTtnQkFDUCxLQUFJLENBQUMsUUFBUSxHQUFHLEtBQUssR0FBRyxZQUFZLENBQUM7Z0JBQ3JDLEtBQUksQ0FBQyxXQUFXLEdBQUcsS0FBSyxDQUFDLE9BQU8sQ0FBQyxNQUFNLENBQUMsR0FBRyxjQUFjLENBQUM7YUFDN0Q7UUFDTCxDQUFDLENBQUMsQ0FBQzs7SUFDUCxDQUFDO0lBRUQsc0NBQWlCLEdBQWpCLFVBQWtCLE1BQU07UUFDcEIsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsU0FBUyxFQUFFLE1BQU0sRUFBRSxFQUFDLEtBQUssRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDO0lBQzlFLENBQUM7SUFFRCx1Q0FBa0IsR0FBbEIsVUFBbUIsTUFBTTtRQUNyQixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxZQUFZLEVBQUUsTUFBTSxFQUFFLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7SUFDakYsQ0FBQztJQUVELHNDQUFpQixHQUFqQixVQUFrQixLQUFLO1FBQ25CLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFHLGVBQWEsS0FBTyxDQUFBLEVBQUUsRUFBRSxFQUFFLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7SUFDckYsQ0FBQztJQUVELHNDQUFpQixHQUFqQixVQUFrQixLQUFLO1FBQ25CLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFHLGVBQWEsS0FBTyxDQUFBLEVBQUUsRUFBRSxFQUFFLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7SUFDckYsQ0FBQztJQUVELHVDQUFrQixHQUFsQixVQUFtQixLQUFLO1FBQ3BCLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFHLGdCQUFjLEtBQU8sQ0FBQSxFQUFFLEVBQUUsRUFBRSxFQUFDLEtBQUssRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDO0lBQ3RGLENBQUM7SUFFRCxrQ0FBYSxHQUFiLFVBQWMsRUFBRTtRQUNaLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFHLGFBQVcsRUFBSSxDQUFBLEVBQUUsRUFBRSxFQUFFLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7SUFDaEYsQ0FBQztJQUVELDRDQUF1QixHQUF2QixVQUF3QixLQUFLO1FBQ3pCLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUFHLGdCQUFnQixFQUFFLEtBQUssRUFBRSxFQUFDLEtBQUssRUFBRSxLQUFLLEVBQUMsQ0FBQyxDQUFDO0lBQ3BGLENBQUM7SUFFRCw4QkFBUyxHQUFULFVBQVUsSUFBSTtRQUNWLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUFHLFlBQVksRUFBRSxJQUFJLEVBQUUsRUFBQyxLQUFLLEVBQUUsS0FBSyxFQUFDLENBQUMsQ0FBQztJQUNoRixDQUFDO0lBRUQsOEJBQVMsR0FBVCxVQUFVLEVBQUUsRUFBRSxJQUFJO1FBQ2QsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxRQUFRLElBQUcsZ0JBQWMsRUFBSSxDQUFBLEVBQUUsSUFBSSxFQUFFLEVBQUMsS0FBSyxFQUFFLEtBQUssRUFBQyxDQUFDLENBQUM7SUFDdEYsQ0FBQztJQUVELG9CQUFvQjtJQUNwQixxQ0FBZ0IsR0FBaEIsVUFBaUIsTUFBTTtRQUNuQixPQUFPLElBQUksQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxpQkFBaUIsRUFBRSxNQUFNLEVBQUUsRUFBQyxLQUFLLEVBQUUsYUFBYSxFQUFDLENBQUMsQ0FBQztJQUM5RixDQUFDO0lBRUQsc0NBQWlCLEdBQWpCLFVBQWtCLE1BQU07UUFDcEIsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsb0JBQW9CLEVBQUUsTUFBTSxFQUFFLEVBQUMsS0FBSyxFQUFFLGFBQWEsRUFBQyxDQUFDLENBQUM7SUFDakcsQ0FBQztJQUVELHNDQUFpQixHQUFqQixVQUFrQixJQUFJO1FBQ2xCLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsUUFBUSxHQUFHLG9CQUFvQixFQUFFLElBQUksRUFBRSxFQUFDLEtBQUssRUFBRSxhQUFhLEVBQUMsQ0FBQyxDQUFDO0lBQ2hHLENBQUM7SUFFRCw0Q0FBdUIsR0FBdkIsVUFBd0IsSUFBSTtRQUN4QixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRywwQkFBMEIsRUFBRSxJQUFJLEVBQUUsRUFBQyxLQUFLLEVBQUUsYUFBYSxFQUFDLENBQUMsQ0FBQztJQUN0RyxDQUFDO0lBRUQsb0JBQW9CO0lBQ3BCLGdDQUFXLEdBQVgsVUFBWSxJQUFJO1FBQ1osT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxRQUFRLEdBQUcsMEJBQTBCLEVBQUUsSUFBSSxFQUFFLEVBQUMsS0FBSyxFQUFFLG1CQUFtQixFQUFDLENBQUMsQ0FBQztJQUM1RyxDQUFDO0lBRUQsZ0NBQVcsR0FBWCxVQUFZLEVBQUUsRUFBRSxJQUFJO1FBQ2hCLE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFHLDhCQUE0QixFQUFJLENBQUEsRUFBRSxJQUFJLEVBQUUsRUFBQyxLQUFLLEVBQUUsbUJBQW1CLEVBQUMsQ0FBQyxDQUFDO0lBQ2xILENBQUM7SUFFRCxnQ0FBVyxHQUFYLFVBQVksRUFBRTtRQUNWLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsUUFBUSxJQUFHLDhCQUE0QixFQUFJLENBQUEsRUFBRSxFQUFFLEVBQUUsRUFBQyxLQUFLLEVBQUUsbUJBQW1CLEVBQUMsQ0FBQyxDQUFDO0lBQy9HLENBQUM7SUFFRCxXQUFXO0lBQ1gsK0JBQVUsR0FBVixVQUFXLEdBQUc7UUFDVixPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxDQUFDLFFBQVEsR0FBRyxjQUFjLEVBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxHQUFHLENBQUMsQ0FBQyxDQUFDO0lBQ2xGLENBQUM7SUFFRCw2QkFBUSxHQUFSLFVBQVMsSUFBSTtRQUNULE9BQU8sSUFBSSxDQUFDLFdBQVcsQ0FBQyxJQUFJLENBQUMsYUFBYSxHQUFHLHVCQUF1QixFQUFFLElBQUksQ0FBQyxDQUFDO0lBQ2hGLENBQUM7SUFFRCxjQUFjO0lBQ2QsK0JBQVUsR0FBVixVQUFXLEVBQUUsRUFBRSxNQUFNO1FBQ2pCLE9BQU8sSUFBSSxDQUFDLFVBQVUsQ0FBQyxJQUFJLENBQUMsV0FBVyxJQUFHLGtCQUFnQixFQUFJLENBQUEsRUFBRSxNQUFNLEVBQUUsRUFBQyxLQUFLLEVBQUUsbUJBQW1CLEVBQUMsQ0FBQyxDQUFDO0lBQzFHLENBQUM7SUFFRCwrQkFBVSxHQUFWLFVBQVcsRUFBRSxFQUFFLE1BQU07UUFDakIsT0FBTyxJQUFJLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxXQUFXLElBQUcsa0JBQWdCLEVBQUksQ0FBQSxFQUFFLE1BQU0sRUFBRSxFQUFDLEtBQUssRUFBRSxtQkFBbUIsRUFBQyxDQUFDLENBQUM7SUFDMUcsQ0FBQztJQUVELGtDQUFhLEdBQWIsVUFBYyxJQUFJO1FBQ2QsT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxXQUFXLEdBQUcsZ0JBQWdCLEVBQUUsSUFBSSxFQUFFLEVBQUMsS0FBSyxFQUFFLG1CQUFtQixFQUFDLENBQUMsQ0FBQztJQUNyRyxDQUFDO3dFQXJHUSxVQUFVO3NEQUFWLFVBQVUsV0FBVixVQUFVLG1CQUZQLE1BQU07cUJBUHRCO0NBK0dDLEFBekdELENBR2dDLFdBQVcsR0FzRzFDO1NBdEdZLFVBQVU7a0RBQVYsVUFBVTtjQUh0QixVQUFVO2VBQUM7Z0JBQ1IsVUFBVSxFQUFFLE1BQU07YUFDckIiLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQge0luamVjdGFibGV9IGZyb20gJ0Bhbmd1bGFyL2NvcmUnO1xuaW1wb3J0IHtIdHRwQ2xpZW50fSBmcm9tICdAYW5ndWxhci9jb21tb24vaHR0cCc7XG5pbXBvcnQge0Jhc2VTZXJ2aWNlfSBmcm9tICcuL2Jhc2Uuc2VydmljZSc7XG5pbXBvcnQge09ic2VydmFibGV9IGZyb20gJ3J4anMnO1xuaW1wb3J0IHtHbG9iYWxTZXJ2aWNlfSBmcm9tICcuL2dsb2JhbC5zZXJ2aWNlJztcblxuQEluamVjdGFibGUoe1xuICAgIHByb3ZpZGVkSW46ICdyb290J1xufSlcbmV4cG9ydCBjbGFzcyBVY2lTZXJ2aWNlIGV4dGVuZHMgQmFzZVNlcnZpY2Uge1xuICAgIEJBU0VfVVJMO1xuICAgIERBVEFTRVRfVVJMO1xuICAgIEZPUk1fQkFTRV9VUkwgPSAnaHR0cHM6Ly9kZXYuc3VuYmlyZGVkLm9yZy8nO1xuXG4gICAgY29uc3RydWN0b3IocHVibGljIGh0dHA6IEh0dHBDbGllbnQsIHB1YmxpYyBnbG9iYWxTZXJ2aWNlOiBHbG9iYWxTZXJ2aWNlKSB7XG4gICAgICAgIHN1cGVyKGh0dHAsIGdsb2JhbFNlcnZpY2UpO1xuICAgICAgICB0aGlzLmdsb2JhbFNlcnZpY2UuYmFzZVVybCQuc3Vic2NyaWJlKHZhbHVlID0+IHtcbiAgICAgICAgICAgIGlmICh2YWx1ZSkge1xuICAgICAgICAgICAgICAgIHRoaXMuQkFTRV9VUkwgPSB2YWx1ZSArICcvYWRtaW4vdjEvJztcbiAgICAgICAgICAgICAgICB0aGlzLkRBVEFTRVRfVVJMID0gdmFsdWUucmVwbGFjZSgnL3VjaScpICsgJy9kYXRhc2V0L3YxLyc7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH1cblxuICAgIGZldGNoQ29udmVyc2F0aW9uKHBhcmFtcyk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFJlcXVlc3QodGhpcy5CQVNFX1VSTCArICdib3QvZ2V0JywgcGFyYW1zLCB7YXNzZXQ6ICdib3QnfSk7XG4gICAgfVxuXG4gICAgc2VhcmNoQ29udmVyc2F0aW9uKHBhcmFtcyk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFJlcXVlc3QodGhpcy5CQVNFX1VSTCArICdib3Qvc2VhcmNoJywgcGFyYW1zLCB7YXNzZXQ6ICdib3QnfSk7XG4gICAgfVxuXG4gICAgcGF1c2VDb252ZXJzYXRpb24oYm90SWQpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZXF1ZXN0KHRoaXMuQkFTRV9VUkwgKyBgYm90L3BhdXNlLyR7Ym90SWR9YCwge30sIHthc3NldDogJ2JvdCd9KTtcbiAgICB9XG5cbiAgICBzdGFydENvbnZlcnNhdGlvbihib3RJZCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFJlcXVlc3QodGhpcy5CQVNFX1VSTCArIGBib3Qvc3RhcnQvJHtib3RJZH1gLCB7fSwge2Fzc2V0OiAnYm90J30pO1xuICAgIH1cblxuICAgIGRlbGV0ZUNvbnZlcnNhdGlvbihib3RJZCk6IE9ic2VydmFibGU8YW55PiB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFJlcXVlc3QodGhpcy5CQVNFX1VSTCArIGBib3QvZGVsZXRlLyR7Ym90SWR9YCwge30sIHthc3NldDogJ2JvdCd9KTtcbiAgICB9XG5cbiAgICBnZXRCb3REZXRhaWxzKGlkKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFJlcXVlc3QodGhpcy5CQVNFX1VSTCArIGBib3QvZ2V0LyR7aWR9YCwge30sIHthc3NldDogJ2JvdCd9KTtcbiAgICB9XG5cbiAgICBnZXRDaGVja1N0YXJ0aW5nTWVzc2FnZShwYXJhbSkge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZXF1ZXN0KHRoaXMuQkFTRV9VUkwgKyBgYm90L2dldEJ5UGFyYW1gLCBwYXJhbSwge2Fzc2V0OiAnYm90J30pO1xuICAgIH1cblxuICAgIGJvdENyZWF0ZShkYXRhKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBvc3RSZXF1ZXN0KHRoaXMuQkFTRV9VUkwgKyAnYm90L2NyZWF0ZScsIGRhdGEsIHthc3NldDogJ2JvdCd9KTtcbiAgICB9XG5cbiAgICBib3RVcGRhdGUoaWQsIGRhdGEpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9zdFJlcXVlc3QodGhpcy5CQVNFX1VSTCArIGBib3QvdXBkYXRlLyR7aWR9YCwgZGF0YSwge2Fzc2V0OiAnYm90J30pO1xuICAgIH1cblxuICAgIC8vIFVzZXIgU2VnbWVudCBBUElzXG4gICAgZmV0Y2hVc2VyU2VnbWVudChwYXJhbXMpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZXF1ZXN0KHRoaXMuQkFTRV9VUkwgKyAndXNlclNlZ21lbnQvZ2V0JywgcGFyYW1zLCB7YXNzZXQ6ICd1c2VyU2VnbWVudCd9KTtcbiAgICB9XG5cbiAgICBzZWFyY2hVc2VyU2VnbWVudChwYXJhbXMpOiBPYnNlcnZhYmxlPGFueT4ge1xuICAgICAgICByZXR1cm4gdGhpcy5nZXRSZXF1ZXN0KHRoaXMuQkFTRV9VUkwgKyAndXNlclNlZ21lbnQvc2VhcmNoJywgcGFyYW1zLCB7YXNzZXQ6ICd1c2VyU2VnbWVudCd9KTtcbiAgICB9XG5cbiAgICBjcmVhdGVVc2VyU2VnbWVudChkYXRhKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBvc3RSZXF1ZXN0KHRoaXMuQkFTRV9VUkwgKyAndXNlclNlZ21lbnQvY3JlYXRlJywgZGF0YSwge2Fzc2V0OiAndXNlclNlZ21lbnQnfSk7XG4gICAgfVxuXG4gICAgdXNlclNlZ21lbnRRdWVyeUJ1aWxkZXIoZGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wb3N0UmVxdWVzdCh0aGlzLkJBU0VfVVJMICsgJ3VzZXJTZWdtZW50L3F1ZXJ5QnVpbGRlcicsIGRhdGEsIHthc3NldDogJ3VzZXJTZWdtZW50J30pO1xuICAgIH1cblxuICAgIC8vIENvbnZlcnNhdGlvbiBBUElzXG4gICAgY3JlYXRlTG9naWMoZGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wb3N0UmVxdWVzdCh0aGlzLkJBU0VfVVJMICsgJ2NvbnZlcnNhdGlvbkxvZ2ljL2NyZWF0ZScsIGRhdGEsIHthc3NldDogJ2NvbnZlcnNhdGlvbkxvZ2ljJ30pO1xuICAgIH1cblxuICAgIHVwZGF0ZUxvZ2ljKGlkLCBkYXRhKSB7XG4gICAgICAgIHJldHVybiB0aGlzLnBvc3RSZXF1ZXN0KHRoaXMuQkFTRV9VUkwgKyBgY29udmVyc2F0aW9uTG9naWMvdXBkYXRlLyR7aWR9YCwgZGF0YSwge2Fzc2V0OiAnY29udmVyc2F0aW9uTG9naWMnfSk7XG4gICAgfVxuXG4gICAgZGVsZXRlTG9naWMoaWQpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVxdWVzdCh0aGlzLkJBU0VfVVJMICsgYGNvbnZlcnNhdGlvbkxvZ2ljL2RlbGV0ZS8ke2lkfWAsIHt9LCB7YXNzZXQ6ICdjb252ZXJzYXRpb25Mb2dpYyd9KTtcbiAgICB9XG5cbiAgICAvLyBNaXMgQVBJc1xuICAgIHVwbG9hZEZpbGUob2JqKTogT2JzZXJ2YWJsZTxhbnk+IHtcbiAgICAgICAgcmV0dXJuIHRoaXMucG9zdFJlcXVlc3QodGhpcy5CQVNFX1VSTCArICdmb3Jtcy91cGxvYWQnLCB0aGlzLnRvRm9ybURhdGEob2JqKSk7XG4gICAgfVxuXG4gICAgcmVhZEZvcm0oZGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wb3N0UmVxdWVzdCh0aGlzLkZPUk1fQkFTRV9VUkwgKyAnYXBpL2RhdGEvdjEvZm9ybS9yZWFkJywgZGF0YSk7XG4gICAgfVxuXG4gICAgLy8gRXhoYXVzdCBBUElcbiAgICBnZXRKb2JMaXN0KGlkLCBwYXJhbXMpIHtcbiAgICAgICAgcmV0dXJuIHRoaXMuZ2V0UmVxdWVzdCh0aGlzLkRBVEFTRVRfVVJMICsgYHJlcXVlc3QvbGlzdC8ke2lkfWAsIHBhcmFtcywge2Fzc2V0OiAnY29udmVyc2F0aW9uTG9naWMnfSk7XG4gICAgfVxuXG4gICAgZ2V0Sm9iSW5mbyhpZCwgcGFyYW1zKSB7XG4gICAgICAgIHJldHVybiB0aGlzLmdldFJlcXVlc3QodGhpcy5EQVRBU0VUX1VSTCArIGByZXF1ZXN0L3JlYWQvJHtpZH1gLCBwYXJhbXMsIHthc3NldDogJ2NvbnZlcnNhdGlvbkxvZ2ljJ30pO1xuICAgIH1cblxuICAgIHN1Ym1pdEV4aGF1c3QoZGF0YSkge1xuICAgICAgICByZXR1cm4gdGhpcy5wb3N0UmVxdWVzdCh0aGlzLkRBVEFTRVRfVVJMICsgYHJlcXVlc3Qvc3VibWl0YCwgZGF0YSwge2Fzc2V0OiAnY29udmVyc2F0aW9uTG9naWMnfSk7XG4gICAgfVxufVxuIl19